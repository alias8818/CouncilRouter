{
  "enabled": true,
  "name": "Pre-Push Security & Cleanup",
  "description": "Validates that sensitive files like .env are not staged for commit, cleans up old documentation or unneeded files, updates .gitignore as needed, creates a logical commit with descriptive notes, and pushes to GitHub",
  "version": "1",
  "when": {
    "type": "userTriggered"
  },
  "then": {
    "type": "askAgent",
    "prompt": "Improved Kiro Agent Hook Prompt:\nBefore performing any Git operations, thoroughly inspect the repository for sensitive information and ensure nothing confidential is committed or pushed:\n\nSecurity First â€“ Protect Secrets:\nNever commit or push files containing sensitive data (e.g., API keys, tokens, passwords, private credentials).\nImmediately check for common secret-containing files such as: .env, .env.local, config.json, secrets.yaml, .aws/credentials, .npmrc, .dockerconfigjson, or any file with words like \"key\", \"secret\", \"password\", or \"token\" in the name.\nIf such files are present and not already ignored, automatically add them to .gitignore before proceeding.\nScan staged or modified files for hardcoded secrets (e.g., strings matching patterns like sk-..., ghp_..., OPENAI_API_KEY=, etc.). If detected, halt and warn before any commit.\nUse Truffflehog as needed. .env is fine as long as it is gitignored.\n\nCleanup & Hygiene:\nRemove outdated, obsolete, or redundant documentation, temporary files, build artifacts, or unused assets (e.g., old README drafts, __pycache__/, node_modules/, .DS_Store, logs, etc.), unless explicitly needed.\nEnsure the repository remains clean and professional in structure.\n\nGitignore Maintenance:\nReview and update .gitignore to include all appropriate patterns for the tech stack (e.g., Python, Node.js, Docker, IDE files, OS artifacts).\nUse standard, comprehensive templates if the current .gitignore is incomplete or outdated.\nNever remove existing valid entries unless clearly erroneous.\n\nCommit & Push Safely:\nStage only intentional, reviewed changes.\nWrite a clear, descriptive, and conventional commit message following best practices (e.g., feat: add user authentication, fix: resolve login redirect loop, docs: update API usage guide).\nInclude context in the commit body if the change is non-trivial.\nAfter committing, push to the remote repository (default branch or specified branch).\nConfirm success and report the commit hash and branch.\n\n\nFinal Instruction:\nProceed only after confirming no sensitive information will be exposed. If any risk is detected, stop immediately and request explicit user confirmation with a detailed warning."
  },
  "workspaceFolderName": "CouncilRouter",
  "shortName": "pre-push-security-check"
}