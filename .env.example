# ============================================================================
# AI Council Proxy - Environment Configuration
# ============================================================================
# Copy this file to .env and fill in your values
# Required fields are marked with (REQUIRED)
# ============================================================================

# ----------------------------------------------------------------------------
# Application Environment
# ----------------------------------------------------------------------------
NODE_ENV=development # development | production | test

# ----------------------------------------------------------------------------
# Database Configuration (PostgreSQL)
# ----------------------------------------------------------------------------
# Docker Compose users: These defaults work out of the box
# Manual setup users: Update with your PostgreSQL credentials

DATABASE_HOST=localhost
DATABASE_PORT=5432
DATABASE_NAME=ai_council_proxy
DATABASE_USER=postgres
DATABASE_PASSWORD=postgres

# Alternative: Use connection string instead of individual fields
# DATABASE_URL=postgresql://postgres:postgres@localhost:5432/ai_council_proxy

# ----------------------------------------------------------------------------
# Redis Configuration
# ----------------------------------------------------------------------------
# Used for session caching, request tracking, and configuration caching

REDIS_HOST=localhost
REDIS_PORT=6379

# Alternative: Use connection string
# REDIS_URL=redis://localhost:6379

# ----------------------------------------------------------------------------
# API Configuration
# ----------------------------------------------------------------------------
API_PORT=3000
API_HOST=0.0.0.0

# JWT Secret for API authentication (REQUIRED in production)
# Generate a secure random string: openssl rand -base64 32
JWT_SECRET=change-this-to-a-secure-random-string-in-production

# ----------------------------------------------------------------------------
# AI Provider API Keys (At least one REQUIRED)
# ----------------------------------------------------------------------------
# Get your API keys from:
# - OpenAI: https://platform.openai.com/api-keys
# - Anthropic: https://console.anthropic.com/settings/keys
# - Google: https://makersuite.google.com/app/apikey

OPENAI_API_KEY=       # sk-...
ANTHROPIC_API_KEY=    # sk-ant-...
GOOGLE_API_KEY=       # AIza...

# ----------------------------------------------------------------------------
# Session Configuration
# ----------------------------------------------------------------------------
# Session timeout in milliseconds (default: 30 minutes)
SESSION_TIMEOUT_MS=1800000

# Maximum context tokens per session (auto-summarizes when exceeded)
SESSION_MAX_CONTEXT_TOKENS=4000

# ----------------------------------------------------------------------------
# Performance Configuration
# ----------------------------------------------------------------------------
# Global timeout for all council processing (seconds)
GLOBAL_TIMEOUT_SECONDS=60

# Enable streaming responses (Server-Sent Events)
ENABLE_STREAMING=true

# Enable fast fallback on timeout (uses partial responses)
ENABLE_FAST_FALLBACK=true

# ----------------------------------------------------------------------------
# Cost Tracking & Budget
# ----------------------------------------------------------------------------
# Alert threshold for total cost (USD)
COST_ALERT_THRESHOLD=100.00

# Currency for cost tracking
COST_CURRENCY=USD

# ----------------------------------------------------------------------------
# Deliberation Configuration
# ----------------------------------------------------------------------------
# Number of deliberation rounds (0-5)
# 0 = no deliberation, just parallel queries
# 1-5 = multiple rounds of peer review and refinement
DELIBERATION_ROUNDS=1

# Deliberation preset: fast | balanced | thorough | research-grade
DELIBERATION_PRESET=balanced

# ----------------------------------------------------------------------------
# Synthesis Configuration
# ----------------------------------------------------------------------------
# Synthesis strategy: consensus-extraction | weighted-fusion | meta-synthesis
SYNTHESIS_STRATEGY=consensus-extraction

# Moderator strategy for meta-synthesis: permanent | rotate | strongest
MODERATOR_STRATEGY=strongest

# ----------------------------------------------------------------------------
# Devil's Advocate Configuration
# ----------------------------------------------------------------------------
# Enable Devil's Advocate critique (challenges consensus)
DEVILS_ADVOCATE_ENABLED=false

# Apply to code requests
DEVILS_ADVOCATE_CODE=true

# Apply to text requests
DEVILS_ADVOCATE_TEXT=false

# Intensity level: light | moderate | thorough
DEVILS_ADVOCATE_INTENSITY=moderate

# ----------------------------------------------------------------------------
# Logging & Monitoring
# ----------------------------------------------------------------------------
# Log level: error | warn | info | debug
LOG_LEVEL=info

# Enable request/response logging
LOG_REQUESTS=true

# Enable cost logging
LOG_COSTS=true

# ----------------------------------------------------------------------------
# Rate Limiting
# ----------------------------------------------------------------------------
# Requests per IP per 15 minutes (0 = unlimited)
RATE_LIMIT_MAX=100

# Rate limit window in milliseconds
RATE_LIMIT_WINDOW_MS=900000

# ----------------------------------------------------------------------------
# Security
# ----------------------------------------------------------------------------
# Enable CORS (comma-separated origins, or * for all)
CORS_ORIGINS=*

# Enable API key authentication (in addition to JWT)
ENABLE_API_KEY_AUTH=true

# ----------------------------------------------------------------------------
# Advanced Configuration (Optional)
# ----------------------------------------------------------------------------
# Provider request timeout (seconds)
PROVIDER_TIMEOUT=30

# Maximum retry attempts per provider
MAX_RETRY_ATTEMPTS=3

# Retry delay (milliseconds)
RETRY_INITIAL_DELAY_MS=1000
RETRY_MAX_DELAY_MS=10000
RETRY_BACKOFF_MULTIPLIER=2

# Provider health check interval (milliseconds)
HEALTH_CHECK_INTERVAL_MS=60000

# ----------------------------------------------------------------------------
# Development / Testing
# ----------------------------------------------------------------------------
# Enable mock providers for testing (no API keys needed)
USE_MOCK_PROVIDERS=false

# Property-based test iterations
PROPERTY_TEST_RUNS=100

# Enable test coverage collection
COLLECT_COVERAGE=false
